<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Runge-Kutta Methods</title>
  <meta name="description" content="        Runge-Kutta Methods    Runge-Kutta Methods The aforementioned Euler's method is the simplest single step ODE solving method, but has a fairly large e...">

  <link rel="canonical" href="https://maystey.github.io/uct_nassp_cm/ode/runge-kutta.html">
  <link rel="alternate" type="application/rss+xml" title="AST4007W Computational Methods" href="https://maystey.github.io/uct_nassp_cm/feed.xml">

  <meta property="og:url"         content="https://maystey.github.io/uct_nassp_cm/ode/runge-kutta.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Runge-Kutta Methods" />
<meta property="og:description" content="        Runge-Kutta Methods    Runge-Kutta Methods The aforementioned Euler's method is the simplest single step ODE solving method, but has a fairly large e..." />
<meta property="og:image"       content="https://maystey.github.io/uct_nassp_cm/images/logo/UCTcircular_logo.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://maystey.github.io/uct_nassp_cm/ode/runge-kutta.html",
  "headline": "Runge-Kutta Methods",
  "datePublished": "2020-06-04T07:48:31+02:00",
  "dateModified": "2020-06-04T07:48:31+02:00",
  "description": "        Runge-Kutta Methods    Runge-Kutta Methods The aforementioned Euler's method is the simplest single step ODE solving method, but has a fairly large e...",
  "author": {
    "@type": "Person",
    "name": "Mayhew Steyn"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://maystey.github.io/uct_nassp_cm",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://maystey.github.io/uct_nassp_cm",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/uct_nassp_cm/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/uct_nassp_cm/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/uct_nassp_cm/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/uct_nassp_cm/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/uct_nassp_cm';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/uct_nassp_cm/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->


<!-- Display Thebelab button in each code cell -->
<script>
/**
 * Set up thebelab button for code blocks
 */

const thebelabCellButton = id =>
  `<a id="thebelab-cell-button-${id}" class="btn thebebtn o-tooltip--left" data-tooltip="Interactive Mode">
    <img src="/uct_nassp_cm/assets/images/edit-button.svg" alt="Start thebelab interactive mode">
  </a>`


const addThebelabButtonToCodeCells =  () => {

  const codeCells = document.querySelectorAll('div.input_area > div.highlight:not(.output) pre')
  codeCells.forEach((codeCell, index) => {
    const id = codeCellId(index)
    codeCell.setAttribute('id', id)
    if (document.getElementById("thebelab-cell-button-" + id) == null) {
      codeCell.insertAdjacentHTML('afterend', thebelabCellButton(id));
    }
  })
}

initFunction(addThebelabButtonToCodeCells);
</script>


<script src="https://unpkg.com/thebelab@latest/lib/index.js" async></script>
<script>
    /**
     * Add attributes to Thebelab blocks
     */

    const initThebelab = () => {
        const addThebelabToCodeCells = () => {
            console.log("Adding thebelab to code cells...");
            // If Thebelab hasn't loaded, wait a bit and try again. This
            // happens because we load ClipboardJS asynchronously.
            if (window.thebelab === undefined) {
                setTimeout(addThebelabToCodeCells, 250)
            return
            }

            // If we already detect a Thebelab cell, don't re-run
            if (document.querySelectorAll('div.thebelab-cell').length > 0) {
                return;
            }

            // Find all code cells, replace with Thebelab interactive code cells
            const codeCells = document.querySelectorAll('.input_area pre')
            codeCells.forEach((codeCell, index) => {
                const id = codeCellId(index)

                // Clean up the language to make it work w/ CodeMirror and add it to the cell
                dataLanguage = ""
                dataLanguage = detectLanguage(dataLanguage);
                codeCell.setAttribute('data-language', dataLanguage)
                codeCell.setAttribute('data-executable', 'true')

                // If the code cell is hidden, show it
                var inputCheckbox = document.querySelector(`input#hidebtn${codeCell.id}`);
                if (inputCheckbox !== null) {
                    setCodeCellVisibility(inputCheckbox, 'visible');
                }
            });

            // Remove the event listener from the page so keyboard press doesn't
            // Change page
            document.removeEventListener('keydown', initPageNav)
            keyboardListener = false;

            // Init thebelab
            thebelab.bootstrap();

            // Remove copy buttons since they won't work anymore
            const copyAndThebeButtons = document.querySelectorAll('.copybtn, .thebebtn')
            copyAndThebeButtons.forEach((button, index) => {
                button.remove();
            });

            // Remove outputs since they'll be stale
            const outputs = document.querySelectorAll('.output *, .output')
            outputs.forEach((output, index) => {
                output.remove();
            });

            // Find any cells with an initialization tag and ask ThebeLab to run them when ready
            var thebeInitCells = document.querySelectorAll('div.tag_thebelab-init');
            thebeInitCells.forEach((cell) => {
                console.log("Initializing ThebeLab with cell: " + cell.id);
                cell.querySelector('.thebelab-run-button').click();
            });
        }

        // Add event listener for the function to modify code cells
        const thebelabButtons = document.querySelectorAll('[id^=thebelab], [id$=thebelab]')
        thebelabButtons.forEach((thebelabButton,index) => {
            if (thebelabButton === null) {
                setTimeout(initThebelab, 250)
                return
            };
            thebelabButton.addEventListener('click', addThebelabToCodeCells);
        });
    }

    // Initialize Thebelab
    initFunction(initThebelab);

// Helper function to munge the language name
var detectLanguage = (language) => {
    if (language.indexOf('python') > -1) {
        language = "python";
    }
    return language;
}
</script>



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/uct_nassp_cm/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  


  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/uct_nassp_cm/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/uct_nassp_cm/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/uct_nassp_cm/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  

  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/uct_nassp_cm/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/uct_nassp_cm/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/uct_nassp_cm/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "YOUR-ORG/YOUR-REPO",
    ref: "gh-pages",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python37364bitbaseconda97808f46a65a4f1e9dfdbcff18a07fbf",
    path: "content/ode"
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="http://www.ast.uct.ac.za/ast/postgraduate/4007w"><img src="/uct_nassp_cm/images/logo/UCTcircular_logo.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">AST4007W Computational Methods</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/intro.html"
        >
          
          Home
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="https://github.com/maystey/uct_nassp_cm">
        <a class="c-sidebar__entry"
          href="https://github.com/maystey/uct_nassp_cm"
        >
          
          GitHub repository
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/intro/intro.html"
        >
          
          Introduction
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/basics/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/basics/intro.html"
        >
          
          Python Basics
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/variables">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/variables.html"
              >
                
                Variables
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/comments">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/comments.html"
              >
                
                Comments
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/types">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/types.html"
              >
                
                Type Conversion
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/operators.html"
              >
                
                Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/assignment-operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/assignment-operators.html"
              >
                
                Assignment Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/functions">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/functions.html"
              >
                
                Introduction to Functions
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/strings">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/strings.html"
              >
                
                Strings
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/basics/string-formatting">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/basics/string-formatting.html"
              >
                
                String Formatting
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/data-structures/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/data-structures/intro.html"
        >
          
          Data Structures
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data-structures/tuple">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/data-structures/tuple.html"
              >
                
                Tuple
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data-structures/lists">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/data-structures/lists.html"
              >
                
                Lists
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/data-structures/dictionaries">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/data-structures/dictionaries.html"
              >
                
                Dictionaries
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/if-statements/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/if-statements/intro.html"
        >
          
          If Statements
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/bools">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/bools.html"
              >
                
                Booleans
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/comparison-operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/comparison-operators.html"
              >
                
                Comparison Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/logical-operators">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/logical-operators.html"
              >
                
                Logical Operators
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/if-statements/if">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/if-statements/if.html"
              >
                
                If Statements
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/loops/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/loops/intro.html"
        >
          
          Loops
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/for">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/for.html"
              >
                
                For Loops
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/list-comp">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/list-comp.html"
              >
                
                List Comprehension
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/while">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/while.html"
              >
                
                While Loops
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/break">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/break.html"
              >
                
                Breaking Out of Loops
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/loops/else">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/loops/else.html"
              >
                
                Else Statement and Loops
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/functions/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/functions/intro.html"
        >
          
          Functions
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/return">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/return.html"
              >
                
                Return Statement
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/arguments">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/arguments.html"
              >
                
                Arguments
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/local-variables">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/local-variables.html"
              >
                
                Local Variables
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/functions/recursive">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/functions/recursive.html"
              >
                
                Recursive Functions
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/file-io/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/file-io/intro.html"
        >
          
          File I/O
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/file-io/file-io">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/file-io/file-io.html"
              >
                
                File I/O
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/file-io/data">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/file-io/data.html"
              >
                
                Data Files
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/benchmarking/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/benchmarking/intro.html"
        >
          
          Benchmarking
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/benchmarking/time">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/benchmarking/time.html"
              >
                
                Measuring Time in Python
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/benchmarking/uncertainty">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/benchmarking/uncertainty.html"
              >
                
                Uncertainty
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/numpy/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/numpy/intro.html"
        >
          
          NumPy
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/arrays">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/arrays.html"
              >
                
                Arrays
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/array-methods">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/array-methods.html"
              >
                
                Array Methods and Attributes
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/arrays2d">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/arrays2d.html"
              >
                
                2D Arrays and Matrices
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/random">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/random.html"
              >
                
                Random Sampling
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/numpy/where">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/numpy/where.html"
              >
                
                Array Conditional Statements and numpy.where()
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/matplotlib/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/matplotlib/intro.html"
        >
          
          Matplotlib
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/matplotlib/simple">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/matplotlib/simple.html"
              >
                
                Simple Plots With Pyplot
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/matplotlib/subplots">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/matplotlib/subplots.html"
              >
                
                Subplots
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/regression/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/regression/intro.html"
        >
          
          Regression and SciPy
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/least-squares">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/least-squares.html"
              >
                
                Linear Least Squares Minimization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/chi-squared">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/chi-squared.html"
              >
                
                Linear Chi Squared Minimization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/multivariate-least-squares">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/multivariate-least-squares.html"
              >
                
                Multivariate Linear Least Squares Minimization
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/regression/scipy">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/regression/scipy.html"
              >
                
                Nonlinear Least Squares Minimization with scipy.optimize.leastsq
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/ode/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/ode/intro.html"
        >
          
          Numerical Solutions to ODEs
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ode/euler">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/ode/euler.html"
              >
                
                Euler's Method
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ode/euler-error">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/ode/euler-error.html"
              >
                
                Truncation Error in Euler's Method
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ode/higher-order">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/ode/higher-order.html"
              >
                
                Solving Higher Order ODEs
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/ode/runge-kutta">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/ode/runge-kutta.html"
              >
                
                Runge-Kutta Methods
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/root-finding/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/root-finding/intro.html"
        >
          
          Numerical Root Finding Techniques
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/root-finding/bisection">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/root-finding/bisection.html"
              >
                
                Bisection Method
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/root-finding/secant">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/root-finding/secant.html"
              >
                
                Secant Method
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/root-finding/newton">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/root-finding/newton.html"
              >
                
                Newton-Raphson Method
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/root-finding/comparison">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/root-finding/comparison.html"
              >
                
                Comparing the Methods
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/integration/intro">
        <a class="c-sidebar__entry"
          href="/uct_nassp_cm/integration/intro.html"
        >
          
          Numerical Integration Techniques
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections u-hidden-visually">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/integration/midpoint">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/integration/midpoint.html"
              >
                
                Midpoint Rule
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/integration/trapezoidal">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/integration/trapezoidal.html"
              >
                
                Trapezoidal Rule
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/integration/simpson">
              <a class="c-sidebar__entry"
                href="/uct_nassp_cm/integration/simpson.html"
              >
                
                Simpson's Rule
              </a>
            </li>
            
            
          
        </ul>
      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/uct_nassp_cm/assets/images/download-solid.svg" alt="Download" /></button>
    <div class="download-buttons">
        <a href="/uct_nassp_cm/content/ode/runge-kutta.ipynb" download>
        <button id="interact-button-download" class="interact-button">.ipynb</button>
        </a>
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


  <button id="interact-button-thebelab" class="interact-button">Thebelab</button>

  
  
  


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/uct_nassp_cm/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/uct_nassp_cm/search.html" class="topbar-right-button" id="search-button">
    <img src="/uct_nassp_cm/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Runge-Kutta Methods</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Runge-Kutta-Methods">Runge-Kutta Methods<a class="anchor-link" href="#Runge-Kutta-Methods"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The aforementioned Euler's method is the simplest single step ODE solving method, but has a fairly large error. The Runge-Kutta methods are more popular due to their improved accuracy, in particular 4th and 5th order methods.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Outline-of-the-Derivation">Outline of the Derivation<a class="anchor-link" href="#Outline-of-the-Derivation"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The idea behind Runge-Kutta is to perform integration steps using a weighted average of Euler-like steps. The following outline <a class="citation" href="#efferson-numerical-methods">(Efferson, 2013)</a> is not a full derivation of the method, as this requires theorems outside the scope of this course.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Second-Order-Runge-Kutta">Second Order Runge-Kutta<a class="anchor-link" href="#Second-Order-Runge-Kutta"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We shall start by looking at second order Runge-Kutta methods. We want to solve an ODE of the form</p>
$$
\frac{dy}{dx} = f(x, y)
$$<p>on the interval $[x_i, x_{i+1}]$, where $x_{i+1} = x_i + h$, with a given initial condition $y(x = x_i) = y_i$. That is we wish to determine the value of $y(x_{i+1}) = y_{i+1}$. We start by calculating the gradient of $y$ at 2 places:</p>
<ul>
<li>The start of the interval: $(x_i, y_i)$</li>
<li>A point inside the interval, for which we approximate the $y$ value using Euler's method: $(x_i + \alpha h, y_i + \alpha h f(x_i, y_i))$, for some choice of $\alpha$.</li>
</ul>
<p><!--- Not necessarily inside the interval though... --->
We then approximate the value of $y_{i+1}$ using Euler's method with each of these gradients:</p>
<ul>
<li>$y_{i+1} \approx y_i + h f(x_i, y_i)$</li>
<li>$y_{i+1} \approx y_i + h f(x_i + \alpha h, y_i + \alpha h f(x_i, y_i))$</li>
</ul>
<p>The final approximation of $y_{i+1}$ is calculated by taking a weighted average of these two approximations:</p>
$$
y_{i+1} \approx y_i + c_1 h f(x_i, y_i) + c_2 h f(x_i + \alpha h, y_i + \alpha h f(x_i, y_i) )
$$<p>where $c_1 + c_2 = 1$ is required.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_remove_input">

<div class="cell border-box-sizing code_cell rendered tag_remove_input">

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/ode/runge-kutta_6_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, how do we go about choosing good values for $c_1$, $c_2$ and $\alpha$? If we Taylor expand the left-hand side of the equation above, and the last term on the right-hand side gives us the relation:</p>
$$
\alpha = \frac{1}{2 c_2}
$$<p>This still gives us a free choice of one of the parameters. Two popular choices are:</p>
<p><strong>The trapezoid rule:</strong> $c1 = c2 = \tfrac{1}{2}$ and $\alpha = 1$, which yields:</p>
$$
y_{i+1} = y_i + \tfrac{1}{2} h \left[ f(x_i, y_i) + f(x_i + h, y_i + h f(x_i, y_i)) \right]
$$<p><strong>The midpoint rule:</strong> $c1 = 0$, $c2 = 1$ and $\alpha = \tfrac{1}{2}$, which yields:</p>
$$
y_{i+1} = y_i + hf\left(x_i + \tfrac{1}{2} h, y_i + \tfrac{1}{2} h f(x_i, y_i) \right)
$$<p>Both of these methods have an accumulated error of $\mathcal(h^2)$, as opposed to Euler's method with $\mathcal(h)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fourth-Order-Runge-Kutta-(RK4)">Fourth Order Runge-Kutta (RK4)<a class="anchor-link" href="#Fourth-Order-Runge-Kutta-(RK4)"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As mentioned, the more popular Runge-Kutta method is the fourth order (for which we will not cover the derivation):</p>
$$
y_{i+1} = y_i + \tfrac{1}{6} h~ (k_1 + 2 k_2 + 2 k_3 + k_4)
$$<p>where the $k$ values are the slopes:</p>
$$
\begin{align*}
k_1 &amp;= f(x_i, y_i)\\
k_2 &amp;= f\left(x_i + \tfrac{1}{2}h, y_i + \tfrac{1}{2} h k_1 \right)\\
k_3 &amp;= f\left(x_i + \tfrac{1}{2}h, y_i + \tfrac{1}{2} h k_2\right)\\
k_4 &amp;= f(x_i + h, y_i + k_3)
\end{align*}
$$<p>$k_1$ is gradient value at the left of the interval. $k_2$ is the gradient at the midpoint of the interval, approximated using $k_1$. The $k_3$ value is the gradient at the midpoint of the interval using $k_2$ to approximate it. $k_4$ is the value of the gradient at the right end of the interval using $k_3$ to approximate it.</p>
<!--- Give interpretation for the the different k terms --->

<p>This method has an accumulated error of $\mathcal(h^4)$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Worked-Example">Worked Example<a class="anchor-link" href="#Worked-Example"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider the ordinary differential equation:</p>
$$
\frac{d y}{dx} = \frac{1}{1 + x^2}
$$<p>with the initial condition $y = 1$ at $x = 0$.</p>
<p>This has the exact solution:</p>
$$
y = 1 + \arctan(x)
$$<p>which we can compare are results to.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="c1">#initial conditions</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">x_end</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">#Differential equation</span>
<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="c1">#Exact solution</span>
<span class="k">def</span> <span class="nf">y_exact</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1">#Constructing the arrays:</span>
<span class="n">x_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x_end</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="c1">#make sure it goes up to and including x_end</span>

<span class="n">y_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>

<span class="c1">#Runge-Kutta method</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    
    <span class="c1">#k values</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>
    <span class="n">k3</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">k2</span><span class="p">)</span>
    <span class="n">k4</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span>
    
    <span class="c1">#update</span>
    <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
    

<span class="c1">#Plotting the solution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_arr</span><span class="p">,</span> <span class="n">y_exact</span><span class="p">(</span><span class="n">x_arr</span><span class="p">),</span> <span class="s1">&#39;-r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Exact solution&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_arr</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">,</span> <span class="s1">&#39;--k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;RK4 solution&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/ode/runge-kutta_12_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="High-Order-ODEs">High Order ODEs<a class="anchor-link" href="#High-Order-ODEs"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we have discussed in a previous page, higher order ODEs can be reduced to a collection of coupled first order ODEs, for example:</p>
\begin{align}
\frac{d y_0}{dx} &amp;= f_0(x, y_0, y_1, \dots, y_{n-1})\\
\frac{d y_1}{dx} &amp;= f_1(x, y_0, y_1, \dots, y_{n-1})\\
\frac{d y_2}{dx} &amp;= f_2(x, y_0, y_1, \dots, y_{n-1})\\
                 &amp;\vdots \\
\frac{d y_{n-1}}{dx} &amp;= f_{n-1}(x, y_0, y_1, \dots, y_{n-1})
\end{align}<p>As we have seen, the Euler's method solution for this is fairly simple. For the RK4 method, things are slightly more complicated. We must decide how to calculate the $k$ values.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
y_{j, i+1} = y_{j, i} + \tfrac{h}{6} (k_{1, j} + 2 k_{2, j} + 2 k_{3, j} + k_{4, j} )
$$<p>Note that the $y_j$ variables are not explicitly dependent on each other, but on the independant variable $x$. Thus we do not have free choice over which $y_j$ values to use when examining another for a particular value of $x$. For any change in $x$, we expect simultenous change in all of the $y_j$. For this reason, when calculating the $k_j$ values for a particular $y_j$, we need to consider the changes in the other $y_l$.</p>
$$
\begin{array}{l l l l l l l}
k_{1, j} &amp;= f_j (x_i, &amp;y_{0, i}~, &amp;\dots, &amp;y_{j, i}~, &amp;\dots, &amp;~y_{n-1, i}~)\\
k_{2, j} &amp;= f_j \big(x_i + \tfrac{1}{2}h, &amp;y_{0, i}~ + \tfrac{1}{2} k_{1, 0}~, &amp;\dots, &amp;y_{j, i}~ + \tfrac{1}{2} k_{1, j}, &amp;\dots, &amp;y_{n-1, i}~ + \tfrac{1}{2} k_{1, n-1}~ \big)\\
k_{3, j} &amp;= f_j \big(x_i + \tfrac{1}{2}h, &amp;y_{0, i}~ + \tfrac{1}{2} k_{2, 0}~, &amp;\dots, &amp;y_{j, i}~ + \tfrac{1}{2} k_{2, j}, &amp;\dots, &amp;y_{n-1, i}~ + \tfrac{1}{2} k_{2, n-1}~\big)\\
k_{4, j} &amp;= f_j ( x_i + h, &amp;y_{0, i}~ + k_{3, 0}~, &amp;\dots, &amp;y_{j, i}~ + k_{3, j}, &amp;\dots, &amp;y_{n-1, i}~ + k_{3, n-1} )\\
\end{array}
$$<p>This looks more complicated then it is to apply in practice. All we need to do is vectorize the solution, as on the previous page. We can represent all the $y_j$ as a vector $\vec{y}$, i.e</p>
$$
\vec{y} = \begin{pmatrix} y_0 \\ y_1 \\ \vdots \\ y_{n-1} \end{pmatrix}
$$<p>the ODE can thus be represented as:</p>
$$
\frac{d \vec{y}}{dx} = \vec{f}(x, \vec{y}) = \begin{pmatrix} f_0 (x, \vec{y}) \\ f_1 (x, \vec{y}) \\ \vdots \\ f_{n-1} (x, \vec{y}) \end{pmatrix}
$$<p>and an update step as:</p>
$$
\vec{y}_{i+1} = \vec{y}_i + \tfrac{1}{6} h (\vec{k_1} + 2 \vec{k_2} + 2 \vec{k_3} + \vec{k_4})
$$<p>where:</p>
$$
\vec{k_m} = \begin{pmatrix} k_{0, m} \\ k_{1, m} \\ \vdots \\ k_{n-1, m} \end{pmatrix}
$$<p>Note that we can write:</p>
$$
\begin{pmatrix}
y_{0, i}~ + \tfrac{1}{2} h k_{1, 0} \\\vdots \\y_{j, i}~ + \tfrac{1}{2} h k_{1, j} \\ \dots \\ y_{n-1, i}~ + \tfrac{1}{2} h k_{1, n-1}
\end{pmatrix}
= \vec{y}_i + \tfrac{1}{2} h \vec{k1}
$$<p>with this in mind, we can simply write the $k$ values as:</p>
\begin{align*}
\vec{k_1} &amp;= \vec{f}(x_i, \vec{y}_i)\\
\vec{k_2} &amp;= \vec{f}\left(x_i + \tfrac{1}{2} h, \vec{y}_i + \tfrac{1}{2} h ~ \vec{k_1} \right)\\
\vec{k_3} &amp;= \vec{f}\left(x_i + \tfrac{1}{2} h, \vec{y}_i + \tfrac{1}{2} h ~ \vec{k_2} \right)\\
\vec{k_4} &amp; = \vec{f}\left(x_i + h, \vec{y}_i + h ~ \vec{k_3} \right)
\end{align*}
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Worked-Example">Worked Example<a class="anchor-link" href="#Worked-Example"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider the third order differential equation:</p>
$$
\frac{d^{4}y}{dx^4} = -12 x y - 4 x^2 \frac{d y}{dx}
$$<p>with the initial conditions: $y(x = 0) = 0$, $y^\prime(0) = 0$ and $y^{\prime\prime}(0) = 2$.</p>
<p>This has an exact solution of:</p>
$$
y(x) = e^{-x^2}
$$<p>which we shall use to test our numerical result.</p>
<p>We shall solve this up to $x = 5$ with steps of size $h = 0.1$.</p>
<p>First we reduce this to a system of first order equations by introducing the variables $y_0(x) = y(x)$, $y_1(x) = y^\prime(x)$ and $y_2(x) = y^{\prime\prime}(x)$:</p>
\begin{align*}
\frac{d y_0}{dx} &amp;= y_1\\
\frac{d y_1}{dx} &amp;= y_2\\
\frac{d y_2}{dx} &amp;= -12 x y_0 - 4 x^2 y_1
\end{align*}
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="c1">#initial conditions</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">x_end</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1">#Important! This must return an array!</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">])</span>

<span class="k">def</span> <span class="nf">y_exact</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="c1">#Constructing the arrays:</span>
<span class="n">x_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">x_end</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="c1">#make sure it goes up to and including x_end</span>

<span class="n">y_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x_arr</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y0</span><span class="p">)))</span>
<span class="n">y_arr</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">y0</span>

<span class="c1">#Runge-Kutta method</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x_arr</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span>
    
    <span class="c1">#k values</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">k2</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">k1</span><span class="p">)</span>
    <span class="n">k3</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">h</span><span class="o">*</span><span class="n">k2</span><span class="p">)</span>
    <span class="n">k4</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">k3</span><span class="p">)</span>
    
    <span class="c1">#update</span>
    <span class="n">y_arr</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">h</span><span class="o">/</span><span class="mi">6</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span>
    

<span class="c1">#Plotting the solution</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_arr</span><span class="p">,</span> <span class="n">y_exact</span><span class="p">(</span><span class="n">x_arr</span><span class="p">),</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_arr</span><span class="p">,</span> <span class="n">y_arr</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">14</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/ode/runge-kutta_18_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References"> </a></h2><p><ol class="bibliography"><li><span id="efferson-numerical-methods">Efferson, J. F. (2013). <i>An Introduction to Numerical Methods and Analysis</i> (Second Edition).</span></li></ol></p>

</div>
</div>
</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/uct_nassp_cm/ode/higher-order.html">
      〈 <span class="u-margin-right-tiny"></span> Solving Higher Order ODEs
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/uct_nassp_cm/root-finding/intro.html">
      Numerical Root Finding Techniques <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
